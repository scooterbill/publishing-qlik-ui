<template>
    <require from="/value-converters/decimal-format"></require>
    <compose view="./save-weights-modal.html"></compose>

    <div class="row perm-container">
        <div class="col-xs-8 col-xs-offset-2">
            <div class="panel panel-default">
                <div class="panel-heading">
                    Permutation Selector
                </div>
                <div class="panel-body">
                    <div class="perm">
                        <label class="control-label">MDS</label>
                        <select class="form-control" id="mds">
                        <option>AH-64D</option>
                        <option>AH-ROFL</option>
                      </select>
                        <input type="number" class="perm-weight-input ${mdsWeightOverride != '' ? 'overridden-font' : ''}" disabled value.bind="mdsWeight | twoDecimalFormat" data-toggle="tooltip" data-placement="bottom"
                            title="MDS Weight">
                        <input type="number" class="${((mdsWeightOverride != '') && (mdsWeight != mdsWeightOverride)) ? 'override-color': ''} perm-weight-input"
                            value.bind="mdsWeightOverride | twoDecimalFormat & updateTrigger:'blur'" data-toggle="tooltip" data-placement="bottom"
                            title="Override MDS Weight">
                    </div>
                    <div class="perm">
                        <label class="control-label">Mission Type</label>
                        <select class="form-control" id="missionType">
                        <option>Imminent Danger</option>
                        <option>Other Danger</option>
                        <option>No Danger</option>
                      </select>
                        <input type="number" class="perm-weight-input ${missionTypeWeightOverride != '' ? 'overridden-font' : ''}" disabled value.bind="missionTypeWeight | twoDecimalFormat" data-toggle="tooltip"
                            data-placement="bottom" title="Mission Type Weight">
                        <input type="number" class="${((missionTypeWeightOverride != '') && (missionTypeWeight != missionTypeWeightOverride)) ? 'override-color': ''} perm-weight-input"
                            value.bind="missionTypeWeightOverride | twoDecimalFormat & updateTrigger:'blur'" data-toggle="tooltip"
                            data-placement="bottom" title="Override Mission Type Weight">
                    </div>
                    <div class="perm">
                        <label class="control-label">Mission Role</label>
                        <select class="form-control" id="missionRole">
                        <option>Air Movement</option>
                        <option>Flight</option>
                        <option>Assault</option>
                      </select>
                        <input type="number" class="perm-weight-input ${missionRoleWeightOverride != '' ? 'overridden-font' : ''}" disabled value.bind="missionRoleWeight | twoDecimalFormat" data-toggle="tooltip"
                            data-placement="bottom" title="Mission Role Weight">
                        <input type="number" class="${((missionRoleWeightOverride != '') && (missionRoleWeight != missionRoleWeightOverride)) ? 'override-color': ''} perm-weight-input"
                            value.bind="missionRoleWeightOverride | twoDecimalFormat & updateTrigger:'blur'" data-toggle="tooltip"
                            data-placement="bottom" title="Override Mission Role Weight">
                    </div>
                    <div class="perm">
                        <label class="control-label">Flight Conditions</label>
                        <select class="form-control" id="flightConditions">
                        <option>Night</option>
                        <option>Day</option>
                        <option>Dusk</option>
                      </select>
                        <input type="number" class="perm-weight-input ${flightConditionsWeightOverride != '' ? 'overridden-font' : ''}" disabled value.bind="flightConditionsWeight | twoDecimalFormat" data-toggle="tooltip"
                            data-placement="bottom" title="Flight Conditions Weight">
                        <input type="number" class="${((flightConditionsWeightOverride != '') && (flightConditionsWeight != flightConditionsWeightOverride)) ? 'override-color': ''} perm-weight-input"
                            value.bind="flightConditionsWeightOverride | twoDecimalFormat & updateTrigger:'blur'" data-toggle="tooltip"
                            data-placement="bottom" title="Override Flight Conditions Weight">
                    </div>
                    <button id="btn-view-results" class="btn btn-primary">View Results</button>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-8 col-xs-offset-2">
            <div class="panel panel-default">
                <div class="panel-heading">
                    Permutation Scenario Results
                </div>
                <div class="panel-body">
                    <table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%">

                        <thead>
                            <tr>
                                <th>Hazard</th>
                                <th>Mean Severity</th>
                                <th>Override Mean Severity</th>
                                <th>Consequence Weighting</th>
                                <th>Override Consequence Weighting</th>
                                <th>Frequency</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr repeat.for="h of hazards">
                                <td>${h.name}</td>
                                <td>
                                    <p class="${h.overrideMeanSeverity != '' ? 'overridden-font' : ''}"> ${h.meanSeverity | twoDecimalFormat}</p>
                                </td>
                                <td>
                                    <input type="number" placeholder="override" class="${((h.overrideMeanSeverity != '') && (h.overrideMeanSeverity != h.meanSeverity)) ? 'override-color': ''}"
                                        value.bind="h.overrideMeanSeverity | twoDecimalFormat & updateTrigger:'blur'">
                                </td>
                                <td>
                                    <p class="${h.overrideConsequenceWeighting != '' ? 'overridden-font' : ''}"> ${h.consequenceWeighting | twoDecimalFormat}</p>
                                </td>
                                <td>
                                    <input type="number" placeholder="override" class="${((h.overrideConsequenceWeighting != '') && (h.overrideConsequenceWeighting != h.consequenceWeighting)) ? 'override-color': ''}"
                                        value.bind="h.overrideConsequenceWeighting | twoDecimalFormat & updateTrigger:'blur'">
                                </td>
                                <td>${h.frequency | twoDecimalFormat}</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="pull-right">
                        <button class="btn btn-cancel" click.trigger="clearWeights()">Cancel</button>
                        <button class="btn btn-primary" data-toggle="modal" data-target="#myModal">Save</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            $('.perm-weight-input').tooltip();
        });
    </script>
</template>